# Exploitation Resources


---
---

# Exploitation
***Abusing misconfigurations and vulnerabilities to gain access to the target.***


In the exploitation phase, we're researching and abusing found vulnerabilities and misconfigurations with the goal of gaining initial access to our target.

Few examples:  
- Abusing a poorly configured web app(E.g., injections, RCE, etc).
- Brute-forcing or abusing default credentials against login services (E.g., email portal, admin panel, VPNs, etc).
- Abusing remote services (VPN, RDP, etc).
- Exploiting unpatched and/or misconfigured services, apps, and hosts (E.g., Kernel vulnerabilities, host and app vulnerabilities and/or misconfigurations, etc).


---
---

This is a list of tools which use exploitation techniques (E.g., Abusing remote services, applications, valid accounts, and more) to gain access to the target.
&nbsp;
{{< admonition type=danger title="Exploit Warning!" open=true >}}
Use caution when downloading and/or executing any malicious code! I'm not responsible for your actions.
{{< /admonition>}}

<br>

Regarding my notes:
- The brackets ( ) after each tool will indicate if the tool is:
    1. (Built-in) = Within Kali's repo. If not already installed, run the following:
        
        ```
        sudo apt update && sudo apt install *tool-to-install*
        ```
    1. (External) = Outside Kali's repo. It'll need downloaded then installed.
    1. (Website) = Part of a website.
    1. There's others but they're self-explanatory.
- I'll also try specifying any restrictions I know of.
    1. API access needed.
    1. Paywalls.
    1. etc.

---
---

### C2 Frameworks

1. <a href="https://github.com/cobbr/Covenant" target="_blank">Covenant</a> - (Built-in) - <span style="color:#0b888a">Windows agents only.</span>
    * Built-In version may be outdated and is the kali repo package called "covenant-kbx".
    * How-To and details at <a href="https://github.com/cobbr/Covenant/wiki" target="_blank">Covenant's Wiki</a>.
    * Based on .NET Core.
    

1. <a href="https://github.com/BC-SECURITY/Empire" target="_blank">Empire</a> - (Built-in) - <span style="color:#0b888a">Windows, Linux, and Mac agents supported.</span>
    * C2 used after post-exploitation.
    * MITRE ATT&CK integration.
    * How-To and Details at <a href="https://bc-security.gitbook.io/empire-wiki/" target="_blank">Empire's Wiki</a>.
    * Client agents use: PowerShell, Python3, C#, and IronPython3.
    * Modules use: AssemblyExecution, BOF Execution, Mimikatz, SeatBelt, Rubeus, SharpSploit, Certify, ProcessInjection, and many more.

1. <a href="https://docs.metasploit.com/" target="_blank">Metasploit</a> - (Built-in) - <span style="color:#0b888a">Windows, Linux, and Mac agents supported.</span>
    * Penetration testing framework usable at any step of a penetration test.
    * Some exploit-db exploits are integrated into the free version. Pro version integrates even more. Integrated exploits searchable via `search`command.
    * Differences of free and pro versions found at <a href="https://www.rapid7.com/products/metasploit/download/editions/" target="_blank">Rapid 7</a>.


1. <a href="https://github.com/its-a-feature/Mythic" target="_blank">Mythic</a> - (Built-in) - <span style="color:#0b888a">Windows, Linux, and Mac agents supported.</span>
    * Many components but very flexible and collab friendly.
    * <a href="https://docs.mythic-c2.net/" target="_blank">Mythic documentation</a>.
    * Many operational pieces like MITRE ATT&CK integration and screenshots. A list found  <a href="https://docs.mythic-c2.net/operational-pieces" target="_blank">here</a>.


1. <a href="https://github.com/trustedsec/trevorc2" target="_blank">TrevorC2</a> - (External) - <span style="color:#0b888a">Windows, Linux, and Mac agents supported.</span>
    * Obfuscation and encoding Client/Server model used for tunneling C2 traffic through a website.
    * Client browser agent reads commands from a custom website's body and sends results back to a server.


1. <a href="https://github.com/BishopFox/sliver" target="_blank">Sliver</a> - (Built-in) - <span style="color:#0b888a">Windows, Linux, and Mac agents supported. Server running Linux recommended.</span>
    * To allow metasploit integrates, server requires metasploit installation.
    * MinGW package required if doing DLL payloads from a Linux server.
    * Written in Golang, so server can run on a variety of platforms, but is larger in size.
    * Simple to standup.


---
---

### Exploits

#### Databases & Forums
1. <a href="https://0x00sec.org/" target="_blank">0x00sec</a> - (Website)
    * How-Tos, discussions, exploits, etc.

1. <a href="https://0day.today/" target="_blank">0day.today</a> - (Website)
    * Newer exploit database that competes with exploit-db.com.
    * Buys and sells exploits.

1. <a href="https://www.exploit-db.com/" target="_blank">Exploit-DB</a> - (Built-in & Website)
    * Largest exploit DB and still reigns king.
    * Locally stored and updated in Kali distribution (/usr/share/exploitdb/).

1. <a href="https://cxsecurity.com/exploit/" target="_blank">CXSecurity DB</a> - (Website)
    * CXSecurity is buy only one person.
    * Free database with PoCs for CVEs, etc.

1. <a href="https://hackforums.net/" target="_blank">Hack Forums</a> - (Website)
    * Older, active forum.

1. <a href="https://www.rapid7.com/db/" target="_blank">Rapid7 DB</a> - (Website) - <span style="color:#0b888a">Premium tier may be required.</span>
    * Rapid7 database which links with metasploit updates.

1. <a href="https://security.snyk.io/" target="_blank">Snyk DB</a> - (Website)
    * Info and remediation guidance of known vulnerabilities.

1. <a href="https://exploits.shodan.io/welcome" target="_blank">Shodan Exploits</a> - (Website)
    * Searches across many platforms for exploits.


1. <a href="https://packetstormsecurity.com/files/tags/exploit/" target="_blank">Packet Storm Files</a> - (Website)
    * Active forum posting exploits.
    * Built to allow researchers share exploits.

1. <a href="https://vulners.com/" target="_blank">Vulners</a> - (Website)
    * Vulnerability Database and Search Engine

#### Git Abuse

1. <a href="https://github.com/internetwache/GitTools" target="_blank">GitTools</a> - (External)
    * Tools used to abuse git version control systems. (E.g. .git/). by downloading then restoring the repository .git folder granting source code access.
    * Great for finding sensitive information in a misconfigured web server hosting Git.

#### PoCs for CVEs

1. <a href="https://github.com/nomi-sec/PoC-in-GitHub" target="_blank">PoC-in-GitHub</a> - (GitHub Repo)
    * GitHup repo which updates regularly with PoCs for the latest CVEs.

1. <a href="https://github.com/trickest/cve" target="_blank">Trickest Repo</a> - (GitHub Repo)
    * Another GitHup repo which updates regularly with PoCs for the latest CVEs.


#### Search for PoCs

1. <a href="https://github.com/search?q=&type=repositories" target="_blank">GitHub Search</a> - (Website)
    * Seriously, you can find allot with GitHub search.

1. <a href="https://www.google.com/" target="_blank">Google</a> - (Website)
    * Seriously, you can find allot with Google.

1. <a href="https://www.exploit-db.com/searchsploit" target="_blank">SearchSploit</a> - (Built-in)
    * CLI tool which searches local exploit-db database.
    * Make sure to update your exploit-db for the latest before searching!

---
---

### Passwords Attacks

#### Hash Identification

1. <a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank">Hashcat's hash example webpage</a> - (Website)
    * Example hashes with their related Hash-Mode number which is needed for option `-m`.

1. <a href="https://github.com/blackploit/hash-identifier" target="_blank">hash-identifier</a> - (Built-in)
    * Helps identify different types of hashes used for data and password encryptions

#### Online Password Attacks

1. <a href="https://nmap.org/ncrack/" target="_blank">ncrack</a> - (Built-in)
    * High-speed network authentication cracking tool.
    * Runs on Linux, *BSD, Windows, and Mac OS X.
    * "Protocols supported include SSH, RDP, FTP, Telnet, HTTP(S), Wordpress, POP3(S), IMAP, CVS, SMB, VNC, SIP, Redis, PostgreSQL, MQTT, MySQL, MSSQL, MongoDB, Cassandra, WinRM, OWA, and DICOM"

1. <a href="https://github.com/lanjelot/patator/" target="_blank">Patator</a> - (Built-in)
    * Written in Python and created out of the frustrations of using Hydra, Medusa, Ncrack, Metasploit modules and Nmap NSE scripts for password guessing attacks.  
    * Supported modules at link above. 
    
1. <a href="https://github.com/vanhauser-thc/thc-hydra" target="_blank">THC-Hydra</a> - (Built-in)
    * Parallelized login cracker supported many protocols.
    * GUI binary is `xhydra`.
    * THC Hydra comes with a handful of additional tools. Cool additional binary `pw-inspector`. You specify the minimum and maximum lengths then the wordlist and it'll create a new wordlist based on lengths specified.
    * Protocols supports includes: Cisco AAA, Cisco auth, Cisco enable, CVS, FTP, HTTP(S)-FORM-GET, HTTP(S)-FORM-POST, HTTP(S)-GET, HTTP(S)-HEAD, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MS-SQL, MySQL, NNTP, Oracle Listener, Oracle SID, PC-Anywhere, PC-NFS, POP3, PostgreSQL, RDP, Rexec, Rlogin, Rsh, SIP, SMB(NT), SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth, VNC and XMPP.
    


#### Offline Password Attacks

1. <a href="http://pogostick.net/~pnh/ntpasswd/" target="_blank">chntpw</a> - (Built-in)
    * From Linux, you can reset or blank out the local passwords by editing the SAM database which stores the Windows password hashes.
    * Note: This only applies to local accounts and not email bound accounts.  

1. <a href="https://hashcat.net/hashcat/" target="_blank">hashcat</a> - (Built-in)
    * "Advanced password recovery"
    * Modules(`-m`) are what tells hashcat which algorithm to use against the hash you provide.
    * My quick process is:
        1. Identifying the hash using [hash-identifer](#hash-identification).
            1. No results? <a href="https://google.com" target="_blank">Google</a> it.
        2. Then I search via CLI `hashcat --help | grep -e '<example-hash-name>` or <a href="https://hashcat.net/wiki/doku.php?id=example_hashes" target="_blank">hashcat's examples webpage</a> for the needed "Hash-Mode".
    * To list the many modes hashcat supports, run:
    ``` bash
    hashcat --help | less +/'Hash modes' 
    ```

1. <a href="https://www.openwall.com/john/" target="_blank">john the ripper</a> - (Built-in)
    * Popular offline cracking tool.
    * Can cover more unique hashes than hashcat but hashcat has better GPU support.
    * Includes many conversion tools, E.g. *2john, as it may need converted. Think of it like the extra step needed with hashcat's `-m` options.
    * Example scenario: You need to crack the passphrase of a SSH private key(RSA, DSA, OPENSSH, EC). `ssh2john` will convert this for john.

1. <a href="https://ophcrack.sourceforge.io/" target="_blank">ophcrack</a> - (Built-in)
    * Supports Windows NT, 2000, XP, VISTA, 7 hashes only.
    * Uses rainbow tables to do cracking based on time-memory trade-off.

#### Zip Password Crackers

1. <a href="http://oldhome.schmorp.de/marc/fcrackzip.html" target="_blank">frackzip</a> - (Built-in)
    * Fast zip password cracker.
    * Brute-force or dictionary based attacks.
    * Can crack cpmask'd images too.

1. <a href="http://rarcrack.sourceforge.net" target="_blank">rarcrack</a> - (Built-in)
    * Cracks .zip, .7z, and .rar.
    * Brute-force only.

1. <a href="https://github.com/openwall/john/blob/bleeding-jumbo/src/zip2john.c" target="_blank">zip2john</a> module - (Built-in)
    * `zip2john example.zip > example.zip.txt` then `sudo john --format=zip example.zip.txt`.
    * If rar format, same as before but `--format=rar`.


---
---

### OS Distributions

#### Create your own

1. <a href="https://github.com/trustedsec/ptf" target="_blank">PTF (Penetration Testers Framework)</a> - (GitHub Repo)
    * Modules way of creating custom OS based on Debian, Arch, or Ubuntu.


#### Malware Analysis

1. <a href="https://github.com/mandiant/flare-vm" target="_blank">FlareVM</a> - (OS)
    * Based on Windows.
    * Includes scripts/tools to allow easy implementation of malware analysis environment.

#### Pentest OSs

1. <a href="https://github.com/mandiant/commando-vm" target="_blank">CommandoVM</a> - (OS)
    * Based on Windows and born from FlareVM.
    * Penetration and Red Teaming VM.


1. <a href="https://www.kali.org/get-kali/#kali-platforms" target="_blank">Kali</a> - (OS)
    * Based on Debian Linux.
    * Forensics & Pentesting OS.

1. <a href="https://www.parrotsec.org/" target="_blank">ParrotOS</a> - (OS)
    * Based on Debian.
    * Pretty and quick GUI.


---
---

### Scanners w/ exploits

#### Network Scanners

1. <a href="https://nmap.org/book/man.html" target="_blank">Nmap</a> (Built-in)
    * The "goto" network and port scanner with many capabilities beyond scanning via NSE.

#### CMS Scanners

1. <a href="https://github.com/Dionach/CMSmap" target="_blank">CMSmap</a> (External)
    * CMSmap is a python open source CMS scanner that automates the process of detecting security flaws of the most popular CMSs.

1. <a href="https://github.com/wpscanteam/wpscan" target="_blank">WPScan</a> (Built-in)
    * WPScan WordPress security scanner. Written for security professionals and blog maintainers to test the security of their WordPress websites.


#### Specialized Scanners

1. <a href="https://github.com/fullhunt/log4j-scan" target="_blank">log4j-scan</a> (External)
    * A fully automated, accurate, and extensive scanner for finding log4j RCE CVE-2021-44228.
    * Supports lists of URLs, 60+ HTTP headers, Bypass payloads for WAFs(Web Application Firewall), etc.

1. <a href="https://github.com/byt3bl33d3r/ItWasAllADream" target="_blank">ItWasAllADream</a> (External)
    * CVE-2021-34527 (PrintNightmare) RCE python scanner.
    * Scan entire subnets for PrintNightmare RCE(Remote code execution) and export CVS report.
    * Does NOT apply to LPE(Local privilege escalation)! Only RCE!

---
---

### Shells, Payloads, & Obfuscation

Shells and Payloads are easy to detect and most of the time you'll need to obfuscate, encode, or use newer methods to compromise a host. Below are some basic resources.  
More can be found searching through the [Additional Resources](#additional-resources) section.

#### Shells & Payloads

1. <a href="https://gist.githubusercontent.com/frohoff/fed1ffaab9b9beeb1c76/raw/7cfa97c7dc65e2275abfb378101a505bfb754a95/revsh.groovy" target="_blank">Groovy Language(Jenkins)</a> (GitHub Repo)
    * WebShell for Groovy Language, usually found on the Jenkins platform. 

1. <a href="https://docs.metasploit.com/docs/using-metasploit/basics/how-to-use-msfvenom.html" target="_blank">MSFVenom</a> (Built-in)
    * Payload and encoding creation tool.
    * Compliments Metasploit as it allows for meterpreter payloads.
    * Easily picked up by many endpoint security, even Windows Defender.

1. <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md" target="_blank">Reverse Cheat Sheet @ PayLoadAllTheThings</a> (GitHub Repo)
    * Many reverse shells.

1. <a href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" target="_blank">PentestMonkey's Reverse Shells</a> (Website)
    * Short list of reverse shells.


1. <a href="https://github.com/tennc/webshell/blob/master/README_EN.md" target="_blank">WebShells</a> (GitHub Repo)
    * Open repo to hosting webshells.
    * As this repo is OPEN, carefully review all code for backdoors before executing!


#### Shell Generators


1. <a href="https://www.revshells.com/" target="_blank">revshells.com</a> (Website)
    * Online generator of many reverse shells.

1. <a href="https://github.com/ShutdownRepo/shellerator" target="_blank">Shellerator</a> (External)
    * Tool used to generate shell code locally. 

1. <a href="https://weibell.github.io/reverse-shell-generator/" target="_blank">Reverse Shell Generator</a> (Website)
    * Online generator of many reverse shells.


#### Obfuscators

1.  <a href="https://www.gaijin.at/en/tools/php-obfuscator" target="_blank">PHP Obfuscator</a> - (Website)
    * Online PHP obfuscator by Gaijin.at
    * Helps hide malicious code by obfuscating it.

1. <a href="https://github.com/samratashok/nishang" target="_blank">Nishang's Shells/Payloads</a> (GitHub Repo)
    * Powershell Scripts and Payloads used to bypass security through means of obfuscation, encoding, etc. 

1. <a href="https://github.com/D3Ext/Vulkan" target="_blank">Vulkan</a> (External)
    * Offensive tool to obfuscate powershell payloads.


---
---

### Web

#### Web App Proxy

1. <a href="https://portswigger.net/burp" target="_blank">BurpSuite</a> (Built-in) - <span style="color:#0b888a">Free version has rate limited brute-forcing. Paid version has many features.</span>
    * AIO web app security testing.
    * Free community extensions can help improve the free version.

1. <a href="https://www.zaproxy.org/" target="_blank">Zed Attack Proxy (ZAP)</a> (Built-in)
    * Free and open-source web app scanner.
    * No limit on brute-force attempts.

1. <a href="https://getfoxyproxy.org/downloads/" target="_blank">Foxy Proxy</a> (Browser Extension)
    * Browser proxy used with ZAP and Burp.

#### Web Code Analysis

1.  <a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a> - (Website & Self-hosted)
    * "The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis".

1.  <a href="https://codebeautify.org/json-decode-online" target="_blank">JSON Decode Online</a> - (Website)
    * Decode JSON cookies.

1.  <a href="https://meyerweb.com/eric/tools/dencoder/" target="_blank">URL Decode & Encode</a> - (Website)
    * Allows you to quickly decode or encode web shells, etc.


#### Web Training

1.  <a href="http://www.itsecgames.com/" target="_blank">bWAPP (buggy WebApp)</a> - (External - Self-Hosted)
    * Older but still effective when practicing the basics.

1. <a href="https://owasp.org/www-project-juice-shop/" target="_blank">OWASP "Juice Shop"</a> - (External - Self-Hosted)
    * OWASP created web server created to gamify(scoreboard) web security learning.
    * Naturally it runs through the <a href="https://owasp.org/www-project-top-ten/" target="_blank">OWASP Top 10</a>.

1. <a href="https://portswigger.net/web-security" target="_blank">PortSwigger Web Security Academy</a> - (Website)
    * Online web security training built from the creators of Burp Suite.


1. <a href="https://github.com/tombstoneghost/TIWAP" target="_blank">Totally Insecure Web Application Project (TIWAP)</a> - (External - Self-Hosted)
    * Web App Security Lab made for learning and practicing web vulnerabilities.

  
---
---

### Wireless

1. <a href="https://github.com/aircrack-ng/aircrack-ng" target="_blank">aircrack-ng</a> - (Built-in)
    * AIO wireless security suite.
    * Contains both passive and active recon tools, along with exploitation tools.


---
---

### Additional Resources

1. <a href="https://www.hackingarticles.in/" target="_blank">HackingArticles.in</a> - (Website)
    * Quick and simple walkthrough guides to various tools and techniques.

1. <a href="https://book.hacktricks.xyz/" target="_blank">HackTricks</a> - (Website)
    * Great resources for anything penetration testing and red teaming.

1.  <a href="https://github.com/0xJs/RedTeaming_CheatSheet/tree/main" target="_blank">0xJs RedTeam CheatSheet</a> - (GitHub Repo)
    * CheatSheet to anything Red Team.

1.  <a href="https://github.com/swisskyrepo/" target="_blank">SwissKy</a> - (GitHub Repo)
    * AIO repo focusing on webapp payloads but includes many other pentesting & red teaming resources.
    * Home for the popular <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/" target="_blank">PayLoadAllTheThings</a> repo.

1. <a href="https://7h3w4lk3rs-organization.gitbook.io/the-hive/" target="_blank">The Hive</a> - (Website)
    * Great resource to search and learn from. Holds many resources that other blogs may lack.
    * Overall great to keep in your notes.

---

> Author: revsh3ll  
> URL: https://PivotTheNet.GitHub.io/exploitation/  

