# Post Exploitation Resources


---
---

# Post-Exploitation
***Abusing vulnerabilities and misconfigurations to maintain access, escalate privileges, and/or exfiltrate sensitive data.***


With our initial access to an internal network, we now focus on acquiring higher-level access through privilege escalation, pivoting to other hosts through lateral movement, stealing sensitive information through data exfiltration, and maintaining access through persistent methods. 

Few examples:
- Abusing misconfigurations in Active Directory, internal services, and/or hosts to gain new privileges and access.
- Bypassing egress filtering through tunneling methods.
- Disabling and/or bypassing AV solutions.
- Stealing sensitive information from compromised hosts.
- Creating persistence to ease our access back into the compromised network/host.

---
---

This is a list of tools which use exploitation techniques (E.g., Abusing remote services, applications, valid accounts, and more) to gain access to the target.
&nbsp;
{{< admonition type=danger title="Exploit Warning!" open=true >}}
Use caution when downloading and/or executing any malicious code! I'm not responsible for your actions. Only attack systems you have written authorization to!
{{< /admonition>}}

<br>

Regarding my notes:
- The brackets ( ) after each tool will indicate if the tool is:
    1. (Built-in) = Within Kali's repo. If not already installed, run the following:
        
        ```
        sudo apt update && sudo apt install *tool-to-install*
        ```
    1. (External) = Outside Kali's repo. It'll need downloaded then installed.
    1. (Website) = Part of a website.
    1. There's others but they're self-explanatory.
- I'll also try specifying any restrictions I know of.
    1. API access needed.
    1. Paywalls.
    1. etc.

---
---

## AIO Resources

1. <a href="https://www.hackingarticles.in/" target="_blank">HackingArticles.in</a> - (Website)
    * Quick and simple walkthrough guides to various tools and techniques.

1. <a href="https://book.hacktricks.xyz/" target="_blank">HackTricks</a> - (Website)
    * Great resources for anything penetration testing and red teaming.

1.  <a href="https://github.com/0xJs/RedTeaming_CheatSheet/tree/main" target="_blank">0xJs RedTeam CheatSheet</a> - (GitHub Repo)
    * CheatSheet to anything Red Team.

1.  <a href="https://github.com/swisskyrepo/" target="_blank">SwissKy</a> - (GitHub Repo)
    * AIO repo focusing on webapp payloads but includes many other pentesting & red teaming resources.
    * Home for the popular <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/" target="_blank">PayLoadAllTheThings</a> repo.

1. <a href="https://7h3w4lk3rs-organization.gitbook.io/the-hive/" target="_blank">The Hive</a> - (Website)
    * Great resource to search and learn from. Holds many resources that other blogs may lack.
    * Overall great to keep in your notes. 

---
---

## Active Directory

### AD Enumeration

1. <a href="https://github.com/dirkjanm/adidnsdump" target="_blank">adidnsdump</a> - (External)
    * "Active Directory Integrated DNS dumping by any authenticated user".
    * Great for initial recon once an AD creds acquired.

1. <a href="https://github.com/BloodHoundAD/BloodHound" target="_blank">BloodHound</a> - (Built-in)
    * Ingests Sharphound/PowerView output and presents AD object relations in a graph-theory approach.

1. <a href="https://github.com/cddmp/enum4linux-ng" target="_blank">enum4linux-ng</a> - (Built-in)
    * Provides Windows/Samba Enumeration.
    * Newer version of the older enum4linux.

1. <a href="https://github.com/ropnop/kerbrute" target="_blank">Kerbrute</a> - (External)
    * Kerberos pre-auth bruteforcer.
    * Wonderful tool for enumerating unknown and valid users!
    * Also does password spraying!

1. <a href="https://github.com/dirkjanm/ldapdomaindump" target="_blank">ldapdomaindump</a> - (External)
    * Collects and parses info available through LDAP then dumps into a human readable HTML format.
    * Also supports json and csv,tsv.

1. <a href="https://docs.ldap.com/ldap-sdk/docs/tool-usages/ldapsearch.html" target="_blank">ldapsearch</a> - (Built-in)
    * Connects, binds, and queries against the LDAP server.

1. <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1" target="_blank">PowerView.ps1</a> - (Built-in)
    * Active Directory enumeration Powershell script.
    * Quick guide @ <a href="https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993" target="_blank">HarmJ0y's PowerView-3.0-tricks</a>.
    * Thorough guide @ <a href="https://powersploit.readthedocs.io/en/latest/Recon/" target="_blank">PowerSploit's wiki</a>. 

1. <a href="https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors" target="_blank">SharpHound</a> - (External)
    * Bloodhound collector.
    * Three versions available:
      1. Sharphound.ps1 - PowerShell  script for running Sharphound. However, the latest release of  Sharphound has stopped releasing the Powershell script version. This  version is good to use with RATs since the script can be loaded directly  into memory, evading on-disk AV scans.
      2. Sharphound.exe - A Windows executable version for running Sharphound.
      3. AzureHound.ps1 - PowerShell  script for running Sharphound for Azure (Microsoft Cloud Computing  Services) instances. Bloodhound can ingest data enumerated from Azure to find attack paths related to the configuration of Azure Identity and Access Management.

1. <a href="https://www.samba.org/samba/docs/current/man-html/smbclient.1.html" target="_blank">smbclient</a> - (Built-in)
    * Access SMB/CIFS resources on servers.
    * "FTP-like" client.

1. <a href="https://github.com/ShawnDEvans/smbmap" target="_blank">smbmap</a> - (Built-in)
    * Another tool that works well with enum4linux to enum SMB.

1. <a href="https://github.com/SnaffCon/Snaffler" target="_blank">Snaffler</a> - (External)
    * Automates the process of enumerating sensitive data dumps from AD file shares.

### AD Exploits & Attacks

1. <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank">CrackMapExec</a> - (Built-in)
    * "Swiss army knife of pentesting networks".
    * Attack AD networks via different protocols.
    * Being replaced with <a href="https://github.com/Pennyw0rth/NetExec" target="_blank">NetExec</a>.

1. <a href="https://github.com/dafthack/DomainPasswordSpray" target="_blank">DomainPasswordSpray</a> - (External)
    * Powershell tool for password spraying from Windows host.
    * Import-Module and run!

1. <a href="https://github.com/Hackplayers/evil-winrm" target="_blank">Evil-WinRM</a> - (Built-in)
    * Have winrm creds, this will allow you to create a overpowered "evil"-winrm shell.

1. <a href="https://github.com/fortra/impacket" target="_blank">Impacket</a> - (Built-in)
    * "Impacket is a collection of Python classes for working with network protocols."

1. <a href="https://github.com/Kevin-Robertson/Inveigh" target="_blank">Inveigh</a> - (External)
    * .NET version of responder, which can run from a Windows host.
    * Great when doing a external to internal attack and need a LLMNR poisoner, among many other protocols.

1. <a href="https://github.com/gentilkiwi/mimikatz" target="_blank">mimikatz</a> - (Built-in)
    * Various authentication attacks for the Windows environment.

1. <a href="https://github.com/dirkjanm/mitm6" target="_blank">mitm6</a> - (External)
    * "pwning IPv4 & IPv6"
    * Takes advantage of misconfigured IPv6 in Windows AD environments.

1. <a href="https://github.com/Pennyw0rth/NetExec" target="_blank">NetExec</a> - (External)
    * "The Network Execution Tool".
    * Replacement for CrackMapExec.

1. <a href="https://github.com/Ridter/noPac" target="_blank">noPac - RCE</a> - (External)
    * Exploiting CVE-2021-42278 and CVE-2021-42287 to impersonate DA from standard domain user.
    * Won't work if KB5008380 & KB5008602 are installed.

1. <a href="https://github.com/dirkjanm/PKINITtools" target="_blank">PetitPotam</a> - (External)
    * Tools for Kerberos PKINIT and relaying to AD CS.

1. <a href="https://github.com/cube0x0/CVE-2021-1675" target="_blank">PrintNightmare - RCE</a> - (External)
    * C# and Impacket implementation of PrintNightmare CVE-2021-1675/CVE-2021-34527.

1. <a href="https://github.com/SpiderLabs/Responder" target="_blank">Responder</a> - (Built-in)
    * "Responder is a LLMNR, NBT-NS and MDNS poisoner, with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server supporting NTLMv1/NTLMv2/LMv2, Extended Security NTLMSSP and Basic HTTP authentication."

1. <a href="https://github.com/GhostPack/Rubeus" target="_blank">Rubeus</a> - (External)
    * Helps automate various Kerberos attacks, like kerboroasting.
    * Part many AD tools @ <a href="https://github.com/GhostPack" target="_blank">GhostPack</a>.

1. <a href="https://github.com/dirkjanm/CVE-2020-1472" target="_blank">ZeroLogon</a> - (External)
    * Tool to check if ZeroLogon in possible without exploiting(breaking) environment!

---
---

## Pivoting Tools

1.  <a href="https://github.com/jpillora/chisel" target="_blank">Chisel</a> - (External)
    * TCP/UDP tunnel over HTTP, secured via SSH, written in Golang.
    * Supports authentication, auto-connect, quick speeds, etc.
    * Requirements:
      * Chisel binary on both compromised host and attackbox.

1.  <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank">plink</a> - (External)
    * On newer systems check for SSH first, then fallback to plink if needed.
    * Always make sure you have the latest version.
    * Requirements:
      * plink.exe binary on compromised **Windows** host.

1. <a href="https://github.com/rofl0r/proxychains-ng" target="_blank">proxychains4</a> - (Build-in)
    * Only works with TCP protocol.
    * Allows you to redirect connections through a SOCKS4/5 or HTTP proxies.
    * You use this with e.g. chisel, ssh, etc. to create tunnels.

1.  <a href="http://www.dest-unreach.org/socat/" target="_blank">socat</a> - (Built-in or External)
    * The relay king and considered a netcat on steroids.
    * The syntax can be difficult but highly worth learning!
    * Requirements:
      * socat binary on compromised system. It's a common found binary on linux systems.
      * Windows binary can be found here: <a href="https://github.com/3ndG4me/socat" target="_blank">socat.exe</a>.

1.  <a href="https://www.openssh.com/" target="_blank">ssh</a> - (Build-in)
    * Flexible binary allowing file transfers, tunneling, port forwarding, proxying, etc.
    * Requirements:
      * SSH server configured for SSH client access.

1.  <a href="https://github.com/sshuttle/sshuttle" target="_blank">SShuttle</a> - (External)
    * Transparent Proxy, via SSH, as an interface.
    * Acts like a VPN tunnel and Supports DNS tunneling.
    * No admin privs required.
    * Requirements: 
      * Linux Only.
      * SSH and Python on compromised host.

---
---

## Linux Local PrivEsc

### Resources - Linux LPE

1. <a href="https://touhidshaikh.com/blog/2018/04/abusing-sudo-linux-privilege-escalation/" target="_blank">Abusing SUDO for LPE</a> - (Website)

1. <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" target="_blank">GotMilk's Basic Linux PrivEsc guide</a> - (Website)

1. <a href="https://github.com/TCM-Course-Resources/Linux-Privilege-Escalation-Resources" target="_blank">Compilation of TCM's LPE course</a> - (Website)

1. <a href="https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist" target="_blank">HackTrick's - Linux PrivEsc Checklist</a> - (Website)

1. <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md" target="_blank">swisskyrepo's - Linux PrivEsc Resources</a> - (Website)

### Enumeration - Linux LPE

1. <a href="https://github.com/rebootuser/LinEnum" target="_blank">LinEnum</a> - (External)
    * Scripted Local Linux Enumeration & Privilege Escalation Checks.

1. <a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS" target="_blank">LinPEAS</a> - (External)
    * Enumerates a Linux host for PrivEsc, etc.

1. <a href="https://github.com/The-Z-Labs/linux-exploit-suggester" target="_blank">Linux Exploit Suggester</a> - (External)
    * Linux PrivEsc auditing tool.

1. <a href="https://github.com/sleventyeleven/linuxprivchecker" target="_blank">Linuxprivchecker.py</a> - (External)
    * "Linux Privilege Escalation Check Script".

1. <a href="https://github.com/DominicBreuker/pspy" target="_blank">Pspy</a> - (External)
    * "Monitor linux processes without root permissions".


### Attacks & Exploits - Linux LPE

1. <a href="https://github.com/saleemrashid/sudo-cve-2019-18634" target="_blank">saleemrashid's CVE-2019-18634 PoC</a> - (External)
    * Exploit for CVE-2019-18634.
    * Needed: Sudo version < 1.8.26 with pwfeedback enabled.

1. <a href="https://github.com/JoyChou93/dirtycow" target="_blank">DirtyCow</a> - (External)
    * DirtyCow kernel exploit. Simply transfer to target, compile, and run.

1. <a href="https://gtfobins.github.io/" target="_blank">GTFObins</a> - (Website)
    * Curated list of Unix binaries which assist in Unix LPE.

1. <a href="https://github.com/lucyoa/kernel-exploits" target="_blank">Linux Kernel Exploits</a> - (Github Repo)
    * Older collection of kernel exploits by lucyoa.

1. <a href="https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/linux-privilege-escalation/#ssh-key" target="_blank">SSH Ket PRNG</a> - (Website)
    * "This module describes how to attempt to use an obtained authorized_keys file on a host system."

1. <a href="https://github.com/TH3xACE/SUDO_KILLER" target="_blank">SUDO Killer</a> - (External)
    * "A tool designed to exploit a privilege escalation vulnerability in the sudo program on Unix-like systems. It takes advantage of a specific misconfiguration or flaw in sudo to gain elevated privileges on the system, essentially allowing a regular user to execute commands as the root user."

---
---

## Windows Local PrivEsc

### Resources - Windows LPE

1. <a href="https://jlajara.gitlab.io/Potatoes_Windows_Privesc" target="_blank">Explained list of Potato attacks and associated links</a> - (Website)

1. <a href="https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/" target="_blank">Windows PrivEsc Guide by absolomb</a> - (Website)

1. <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md" target="_blank">swisskyrepo's - Windows PrivEsc Guide</a> - (Website)

1. <a href="https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html" target="_blank">sushant747's - Windows PrivEsc Guide</a> - (Website)

### Enumeration - Windows LPE

1. <a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc" target="_blank">PowerUp</a> - (External)
    * Powershell module for checking on PrivEsc.

1. <a href="https://github.com/GhostPack/Seatbelt" target="_blank">Seatbelt</a> - (External)
    * C# Windows enumeration tool.
    * More granular WinPEAS...
    *  <a href="https://github.com/carlospolop/winPE/tree/master/binaries/seatbelt" target="_blank">Precompiled Static Binaries</a>.
    * Part many AD tools @ <a href="https://github.com/GhostPack" target="_blank">GhostPack</a>.

1. <a href="https://github.com/GhostPack/SharpUp" target="_blank">SharpUp</a> - (External)
    * C# port of PowerUp functionality.

1. <a href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS" target="_blank">WinPEAS</a> - (External)
    * Enumerate a Windows host for PrivEsc.
    * Requires .NET 4.0 or higher.

1. <a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester" target="_blank">Windows Exploit Suggester</a> - (External)
    * This tool compares a targets patch levels against the Microsoft vulnerability database in order to detect potential missing patches on the target. It also notifies the user if there are public exploits and Metasploit modules available for the missing bulletins.

1. <a href="https://www.rapid7.com/blog/post/2015/08/11/metasploit-local-exploit-suggester-do-less-get-more/" target="_blank">Windows Exploit Suggester</a> - (External)
    * MSFconsole's Windows exploit suggestion module.

1. <a href="https://github.com/rasta-mouse/Sherlock" target="_blank">Sherlock</a> - (Build-in)
    * PowerShell script to quickly find missing software patches for local privilege escalation vulnerabilities.

### Expoits & Attacks - Windows LPE

1. <a href="https://github.com/foxglovesec/Potato" target="_blank">Hot Potato</a> - (External)
    * Compatible with Windows 7, 8, 10, Server 2008, Server 2012.
    * Local Privilege Escalation (LPE) abusing NBNS spoofing, NTLM relay, and WPAD proxy server.

1. <a href="https://github.com/ohpe/juicy-potato" target="_blank">Juicy Potato</a> - (External)
    * "A sugared version of RottenPotatoNG, with a bit of juice, i.e. another Local Privilege Escalation tool, from a Windows Service Accounts to NT AUTHORITY\SYSTEM".

1. <a href="https://lolbas-project.github.io/#" target="_blank">LOLBAS</a> - (Website)
    * Curated list of binaries and scripts which assist in Windows LPE.

1. <a href="https://github.com/calebstewart/CVE-2021-1675" target="_blank">PrintNightmare</a> - (External)
    * Pure PowerShell implementation of CVE-2021-1675 Print Spooler Local Privilege Escalation (PrintNightmare).

1. <a href="https://github.com/itm4n/PrintSpoofer" target="_blank">PrintSpoofer</a> - (External)
    * Abusing impersonation privileges through the "Printer Bug".
    * Server 2019 and Windows 10.

1. <a href="https://github.com/foxglovesec/RottenPotato" target="_blank">Rotten Potato</a> - (External)
    * "RottenPotato local privilege escalation from service account to SYSTEM".
    * Authenticating attacker by tricking DCOM/RPC into using NTLM.

1. <a href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank">Windows Kernel Exploits</a> - (External)
    * Curated list of Windows kernel exploits.

---

> Author: revsh3ll  
> URL: https://PivotTheNet.GitHub.io/post-exploitation/  

